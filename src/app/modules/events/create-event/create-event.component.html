<loading-screen [message]="msg" *ngIf="loading; else content"></loading-screen>
<ng-template #content>
  <div *ngIf="!isCreator; else notVerified">
    <div class="apply-creator">
      <h3>Apply to become Event Organizer</h3>
      <button class="btn btn-primary" (click)="eventsService.applyCreator()">
        APPLY
      </button>
    </div>
  </div>

  <ng-template #notVerified>
    <div *ngIf="!creatorVerified && isCreator; else createEvent">
      <div class="apply-creator">
        <h3>Your application is not verified yet, come back later</h3>
      </div>
    </div>
  </ng-template>
  <ng-template #createEvent>
    <div class="container-fluid contain">
      <div
        class="tab-pane fade show active"
        id="sidebar-1-1"
        role="tabpanel"
        aria-labelledby="sidebar-1-1"
      >
        <!-- Page Heading -->
        <form
          [formGroup]="createEventForm"
          (ngSubmit)="onSubmit()"
          class="user"
        >
          <div class="row gutter-1">
            <div class="col-md-6 mb-3">
              <h1 class="h2 text-gray-900">Event Details</h1>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput1">Event Name</label>
                    <input
                      id="exampleInput1"
                      type="text"
                      class="form-control"
                      placeholder="Event Name"
                      formControlName="eventName"
                    />
                    <span
                      class="err"
                      *ngIf="
                        fc.eventName.invalid &&
                        (fc.eventName.dirty || fc.eventName.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput2">Organized By</label>
                    <input
                      id="exampleInput2"
                      type="text"
                      class="form-control"
                      placeholder="Organized By"
                      formControlName="eventOrganizedBy"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        fc.eventOrganizedBy.invalid &&
                        (fc.eventOrganizedBy.dirty ||
                          fc.eventOrganizedBy.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="inputGroupSelect01">Choose Categories</label>
                <select
                  class="custom-select"
                  id="inputGroupSelect01"
                  formControlName="eventCategory"
                >
                  <option selected>Choose...</option>
                  <option
                    *ngFor="let category of eventsService.categories; async"
                    [value]="category.name"
                  >
                    {{ category.name }}</option
                  >
                </select>
                <span
                  class="text-danger"
                  *ngIf="
                    fc.eventCategory.invalid &&
                    (fc.eventCategory.dirty || fc.eventCategory.touched)
                  "
                >
                  This field is required.
                </span>
              </div>

              <div class="form-group">
                <label for="exampleInput3">Description</label>
                <textarea
                  class="form-control"
                  rows="3"
                  placeholder="Event summary in few words"
                  formControlName="eventDescription"
                ></textarea>
                <span
                  class="text-danger"
                  *ngIf="
                    fc.eventDescription.invalid &&
                    (fc.eventDescription.dirty || fc.eventDescription.touched)
                  "
                >
                  This field is required.
                </span>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput7">Event Starting date</label>
                    <ngb-datepicker
                      #dp
                      formControlName="eventDate"
                      [minDate]="today"
                    ></ngb-datepicker>
                    <span
                      class="text-danger"
                      *ngIf="
                        fc.eventDate.invalid &&
                        (fc.eventDate.dirty || fc.eventDate.touched)
                      "
                    >
                      This field is required.
                    </span>
                    <!--<input
                      id="exampleInput7"
                      type="date"
                      class="form-control"
                      placeholder="Event startng date"
                      formControlName="eventDate"
                    />-->
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput7">Event's Time</label>
                    <input
                      type="time"
                      id="exampleInput7"
                      class="form-control"
                      placeholder="Time"
                      formControlName="eventTiming"
                    />
                    <!-- <input
                      id="exampleInput7"
                      type="date"
                      class="form-control"
                      placeholder="Due date"
                      formControlName="eventDueDate"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        fc.eventDueDate.invalid &&
                        (fc.eventDueDate.dirty || fc.eventDueDate.touched)
                      "
                    >
                      This field is required.
                    </span> -->
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput6">No. of Tickets</label>
                    <input
                      id="exampleInput6"
                      type="number"
                      class="form-control"
                      placeholder="Number of Tickets"
                      formControlName="eventTickets"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        fc.eventTickets.invalid &&
                        (fc.eventTickets.dirty || fc.eventTickets.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput6">Ticket Price</label>
                    <input
                      id="exampleInput6"
                      type="number"
                      class="form-control"
                      placeholder="Ticket Price"
                      formControlName="eventTicketPrice"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        fc.eventTicketPrice.invalid &&
                        (fc.eventTicketPrice.dirty ||
                          fc.eventTicketPrice.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label for="exampleInput6">Redirect URl</label>
                <input
                  id="exampleInput6"
                  type="url"
                  class="form-control"
                  placeholder="Redirect URL"
                  formControlName="eventRedirectUrl"
                  [pattern]="reg"
                />
                <span
                  class="text-danger"
                  *ngIf="
                    fc.eventRedirectUrl.invalid &&
                    (fc.eventRedirectUrl.dirty || fc.eventRedirectUrl.touched)
                  "
                >
                Enter a valid link.
                </span>
              </div>
            </div>

            <!-- Contact Details -->
            <div class="col-md-6 mb-3" formGroupName="eventDetails">
              <h1 class="h2 text-gray-900">Contact Details</h1>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput7">Email</label>
                    <input
                      id="exampleInput7"
                      type="text"
                      class="form-control"
                      placeholder="Email"
                      formControlName="eventEmail"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventEmail.invalid &&
                        (dfc.eventEmail.dirty || dfc.eventEmail.touched)
                      "
                    >
                      Email is badly formated
                    </span>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput6">Phone no</label>
                    <input
                      id="exampleInput6"
                      type="number"
                      class="form-control"
                      placeholder="Phone Number to Contact"
                      formControlName="eventPhoneNumber"
                      [pattern]="mobNumberPattern"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventPhoneNumber.invalid &&
                        (dfc.eventPhoneNumber.dirty ||
                          dfc.eventPhoneNumber.touched)
                      "
                    >
                      Enter valid number.
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="exampleInput4">Venue address</label>
                <input
                  id="exampleInput4"
                  type="text"
                  class="form-control"
                  placeholder="Event Address, Meeting point, Venue address"
                  formControlName="eventAddress"
                />
                <span
                  class="text-danger"
                  *ngIf="
                    dfc.eventAddress.invalid &&
                    (dfc.eventAddress.dirty || dfc.eventAddress.touched)
                  "
                >
                  This field is required.
                </span>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput4">City</label>
                    <input
                      id="exampleInput4"
                      type="text"
                      class="form-control"
                      placeholder="City"
                      formControlName="eventCity"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventCity.invalid &&
                        (dfc.eventCity.dirty || dfc.eventCity.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput5">Zip</label>
                    <input
                      id="exampleInput5"
                      type="number"
                      class="form-control"
                      placeholder="Zip"
                      formControlName="eventZip"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventZip.invalid &&
                        (dfc.eventZip.dirty || dfc.eventZip.touched)
                      "
                    >
                      This field is required.
                    </span>
                  </div>
                </div>
              </div>

              <div class="h5 mt-3 text-gray-900">Social Media Links</div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput4">Instgram</label>
                    <input
                      id="exampleInput4"
                      type="url"
                      class="form-control"
                      placeholder="Instgram profile url"
                      formControlName="eventSocialInstagram"
                      [pattern]="reg"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventSocialInstagram.invalid &&
                        (dfc.eventSocialInstagram.dirty ||
                          dfc.eventSocialInstagram.touched)
                      "
                    >
                    Enter a valid link.
                    </span>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="exampleInput5">Facebook</label>
                    <input
                      id="exampleInput5"
                      type="url"
                      class="form-control"
                      placeholder="Facebook Pag url"
                      formControlName="eventSocialFacebook"
                      [pattern]="reg"
                    />
                    <span
                      class="text-danger"
                      *ngIf="
                        dfc.eventSocialFacebook.invalid &&
                        (dfc.eventSocialFacebook.dirty ||
                          dfc.eventSocialFacebook.touched)
                      "
                    >
                      Enter a valid link.
                    </span>
                  </div>
                </div>
              </div>

              <div class="h5 mt-3 text-gray-900">Frequenty Asked Questions</div>
              <textarea
                class="form-control"
                rows="2"
                placeholder="Frequently Asked Questions"
                formControlName="eventFaq"
              ></textarea>
              <span
                class="text-danger"
                *ngIf="
                  dfc.eventFaq.invalid &&
                  (dfc.eventFaq.dirty || dfc.eventFaq.touched)
                "
              >
                This field is required.
              </span>
              <div class="row">
                <div class="col">
                  <div class="form-group">
                    <label for="exampleInput5">Upload image for poster</label>
                    <input
                      type="file"
                      (change)="getPoster($event)"
                      accept=".png,.jpg"
                    />
                  </div>
                </div>
                <div class="col">
                  <div class="form-group">
                    <label for="exampleInput5">Upload image for banner</label>
                    <input
                      type="file"
                      (change)="getBanner($event)"
                      accept=".png,.jpg"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <button
                type="submit"
                [disabled]="createEventForm.invalid || loading"
                class="btn btn-primary"
              >
                Create Event
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </ng-template>
</ng-template>
